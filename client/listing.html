<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Listing Details</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <header>
        <h1><a href="index.html">üè° MyHemnet</a></h1>
        <nav><a href="index.html">Back to Listings</a></nav>
    </header>

    <div class="container">
        <div id="detail-box"
            style="background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
            <h1 id="d-title" style="margin-top: 0;">Loading...</h1>
            <h2 id="d-price" style="color: var(--primary);"></h2>
            <p id="d-desc" style="font-size: 1.1em; line-height: 1.6; color: #555;"></p>

            <hr style="border: 0; border-top: 1px solid #eee; margin: 30px 0;">

            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; font-size: 1.1em;">
                <div><strong>Living Area:</strong> <span id="d-area"></span> m¬≤</div>
                <div><strong>Rooms:</strong> <span id="d-rooms"></span></div>
                <div><strong>Year Built:</strong> <span id="d-year"></span></div>
                <div><strong>Listing ID:</strong> <span id="d-id"></span></div>
            </div>
        </div>
    </div>

    <script>
        // 1. Get ID from URL
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');

        async function loadOne() {
            if (!id) {
                document.getElementById('d-title').innerText = "No House Selected";
                return;
            }

            try {
                // 2. Fetch specific house
                const res = await fetch(`http://127.0.0.1:8000/listings/${id}`);

                if (!res.ok) throw new Error("Not found");

                const house = await res.json();

                // 3. Update page
                document.getElementById('d-title').innerText = house.title;
                document.getElementById('d-price').innerText = house.price.toLocaleString() + " SEK";
                document.getElementById('d-desc').innerText = house.description;
                document.getElementById('d-area').innerText = house.living_area;
                document.getElementById('d-rooms').innerText = house.room_count;
                document.getElementById('d-year').innerText = house.year_built;
                document.getElementById('d-id').innerText = house.id;

            } catch (err) {
                document.getElementById('detail-box').innerHTML = '<h2 style="color:red">House not found (404)</h2><p>This house may have been deleted.</p>';
            }
        }
        loadOne();
    </script>
</body>

</html>